- content_for :head do
  = social_meta_tags_venue
  = rss_link_tag t('.feed_title', title: @venue.title)

- content_for :title do
  = t('.title', title: @venue.title)

- content_for :facebook_values do
  = render(:partial => 'facebook_value_template', :locals => { :venue => @venue } )

.user-box.row
  .large-12.columns
    = link_to @venue.user do
      = render partial: "shared/avatar_image", locals: { user: @venue.user, size: 50 }
      %h4.venue-user= @venue.user.name
    = render partial: 'shared/social_share', locals: { shareable_id: @venue.id, shareable_type: 'venue' }

.title-box.row.collapse-large-only
  .large-12.columns
    %h2.venue-title.left= @venue.title
    - if can? :manage, @venue
      = link_to t('.edit_venue'), [:edit, @venue], class: "title-edit"

.image-box.row.collapse-large-only
  .large-12.columns
    = image_tag @venue.image.thumb("700x361#nw").url, class: 'image'

.action-box.row.collapse-large-only
  .anker-links.large-6.medium-6.columns
    -# TODO check the intelligibility of the following 3 unlesses
    - unless @venue.talks.empty?
      .black-background-box
        - unless @upcoming_talks.empty?
          = link_to '#upcoming-talks' do
            = t('.upcoming_talks', count: @upcoming_talks.count)
        %span.icon-mic
        - unless @archived_talks.empty?
          = succeed '<a>, </a>'.html_safe do # horrible hack!
            = link_to '#archived-talks' do
              = t('.archived_talks', count: @archived_talks.count)
        %a= t('.plays', count: @total_plays)

  .action-links.large-6.medium-6.columns
    .align-box
      - if can? :manage, @venue
        = link_to new_talk_path(talk: { venue_id: @venue.id }) do
          %span.icon-mic
          = t('.create_new_talk')
        = link_to new_upload_path(talk: { venue_id: @venue.id }) do
          %span.icon-upload-cloud
          = t('.upload_talk')
      - else
        = link_to_podcast(@venue)
        - if @show_join
          = link_to [@venue, :participations], method: :post do
            = t('.subscribe_to_series')
        - elsif !current_user
          %a(href="#" data-reveal-id="modal-login-signup")
            = t('.subscribe_to_series')
        - if @participation
          = link_to [@venue, @participation], delete_params do
            = t('.unsubscribe_to_series')

- unless @live_talks.empty?
  .live-talks-box.row.collapse-large-only
    .large-12.columns
      %header.title-header.clearfix
        %h3.left= t('.live_talks', count: @live_talks.count)
        .onair.right= t('.on_air')
      %ul(class="#{talkslive_grid(@live_talks)}")
        = render partial: talkslive_partial(@live_talks), :locals => { color: 'box-live' }, collection: @live_talks

- unless @upcoming_talks.empty?
  .upcoming-talks-box.row.collapse-large-only
    .large-12.columns
      %h3= t('.upcoming_talks', count: @upcoming_talks.count)
      %ul(class="#{talks_grid(@upcoming_talks)}")
        -# TODO show only the first 3
        = render partial: talks_partial(@upcoming_talks), :locals => { color: 'box-slim' }, collection: @upcoming_talks
      -# TODO open all
      -#= link_to t('.more'), '#', class: 'link-more'

- unless @archived_talks.empty?
  .archived-talks-box.row.collapse-large-only
    .large-12.columns
      %h3= t('.archived_talks', count: @archived_talks.count)
      %ul(class="#{talks_grid(@archived_talks)}")
        -# TODO show only the first 3
        = render partial: talks_partial(@archived_talks), :locals => { color: 'box-slim' }, collection: @archived_talks
      -# TODO open all
      -#= link_to t('.more'), '#', class: 'link-more'

.description-box.row.collapse-large-only
  .large-12.columns
    .align-box
      %h3= t('.description')
      = @venue.description_as_html.html_safe
      - if can? :manage, @venue
        = link_to t('.edit_venue'), [:edit, @venue], class: "desc-edit"
